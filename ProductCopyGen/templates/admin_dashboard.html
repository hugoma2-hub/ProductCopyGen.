<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Admin Dashboard - ProductCopyGen</title>
<style>
  body { font-family: Arial, sans-serif; background:#f9fafb; margin:0; padding:20px; color:#111827;}
  h1 { color:#4f46e5;}
  section { margin-bottom:40px; }
  button { padding:10px 15px; background:#4f46e5; color:white; border:none; border-radius:6px; cursor:pointer;}
  button:hover { background:#3730a3; }
  .list { background:white; padding:15px; border-radius:10px; box-shadow:0 3px 8px rgba(0,0,0,0.1); margin-top:10px; max-height:300px; overflow:auto;}
</style>
</head>
<body>
<h1>Admin Dashboard</h1>

<section>
  <h2>Usos restantes (actual)</h2>
  <p id="usosDisplay">{{ usos }}</p>
  <button onclick="resetUsos()">Resetear usos a 3</button>
</section>

<section>
  <h2>Emails recibidos</h2>
  <button onclick="clearEmails()">Borrar todos los emails</button>
  <button onclick="downloadEmails()">Descargar CSV</button>
  <div class="list" id="emailList">
    {% for e in emails %}
      <div>{{ e }}</div>
    {% else %}
      No hay emails
    {% endfor %}
  </div>
</section>

<section>
  <h2>Historial completo de descripciones</h2>
  <div class="list" id="historyList">
    {% for h in history %}
      <div>{{ h }}</div>
    {% else %}
      No hay historial
    {% endfor %}
  </div>
</section>

<script>
async function resetUsos() {
  if(confirm("¿Seguro que quieres resetear los usos a 3 para todos?")){
    await fetch("/reset_usos", {method:"POST"});
    document.getElementById("usosDisplay").innerText = 3;
    alert("✅ Usos reseteados a 3.");
  }
}

async function clearEmails() {
  if(confirm("¿Seguro que quieres borrar todos los emails?")){
    await fetch("/clear_emails", {method:"POST"});
    document.getElementById("emailList").innerHTML = "No hay emails";
    alert("✅ Emails borrados.");
  }
}

function downloadEmails() {
  window.location.href = "/download_emails";
}
</script>
</body>
</html>


